* CREATE A CROSS PRODUCT OF ALL POSSIBLE MARKET-WEEKS;

LIBNAME DTC "\\WPUSHH01\DINFOPLN\PRA\DTC\NuvaRing\2010 profit plan\SAS datasets";
LIBNAME NEWIN "\\WPUSHH01\DINFOPLN\PRA\DTC\NuvaRing\2010 profit plan\SAS datasets";

* CREATE DUMMY DATASET WHICH INCLUDES ONE OBS PER WEEK AND A WEEK NUMBER;
	* USE NATIONAL FILE FOR EFFICIENCY;

PROC SORT DATA=NEWIN.NATL_TV_MM (KEEP=REPORT_PERIOD MONTH YEAR) OUT=TWEEKS1 NODUPKEY; 
	BY REPORT_PERIOD; RUN;

DATA MISSING;
    INFORMAT REPORT_PERIOD DATE9.;
	FORMAT REPORT_PERIOD DATE9. MONTH YEAR BEST12.;
	INPUT YEAR MONTH REPORT_PERIOD;
	DATALINES;
	2007 5 07MAY2007
	2007 5 28MAY2007
	2007 7 09JUL2007
	2007 12 10DEC2007
	2007 12 31DEC2007
	2008 1 07JAN2008
	2008 3 24MAR2008
	2008 3 31MAR2008
	2008 4 28APR2008
	2008 5 12MAY2008
	2009 4 20APR2009
	2009 5 25MAY2009
	2009 6 29JUN2009
	2009 12 28DEC2009
	;
	
RUN;

PROC PRINT DATA=MISSING; RUN;

DATA TWEEKS2; SET TWEEKS1 MISSING; BY REPORT_PERIOD; FORMAT MONYY MONYY5.; MONYY=(MDY(MONTH,1,YEAR));
RUN;

PROC SORT DATA=TWEEKS2; BY REPORT_PERIOD; RUN;

DATA DTC.WEEKS_DEC09; SET TWEEKS2;
	WEEK=_N_; MONTHLABEL=PUT((MDY(MONTH,1,YEAR)),MONYY5.); RUN;

PROC PRINT DATA=DTC.WEEKS_DEC09 (OBS=10); RUN;

* CREATE DUMMY DATASET WHICH INCLUDES ONE OBS PER MARKET;

PROC SORT DATA= NEWIN.LOCL_TV_MM (KEEP=MARKET) OUT=DTC.MARKETS_DEC09 NODUPKEY; 
	BY MARKET; RUN;

PROC PRINT DATA=DTC.MARKETS_DEC09 (OBS=10); RUN;

* CREATE A CROSS PRODUCT OF ALL POSSIBLE MARKET-WEEKS;
PROC SQL;
    CREATE TABLE DTC.MARKET_WEEKS_DEC09 AS
    SELECT MARKET, MONYY, REPORT_PERIOD, WEEK
    FROM DTC.MARKETS_DEC09, DTC.WEEKS_DEC09; QUIT;

PROC PRINT DATA=DTC.MARKET_WEEKS_DEC09 (OBS=10); RUN;

PROC SORT DATA=DTC.MARKET_WEEKS_DEC09; BY MARKET REPORT_PERIOD; RUN;

PROC FREQ DATA=DTC.MARKET_WEEKS_DEC09; TABLES REPORT_PERIOD*WEEK/LIST MISSING; RUN;
